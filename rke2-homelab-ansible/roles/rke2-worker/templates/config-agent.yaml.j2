# RKE2 Agent Configuration
node-name: {{ inventory_hostname }}
node-ip: {{ ansible_default_ipv4.address }}

# Join cluster
# Workers must connect directly to the first master, not the load balancer
server: https://{{ groups['rke2_masters'][0] }}:{{ rke2_supervisor_port | default('9345') }}
token: {{ cluster_token }}

# Node labels
node-label:
{% for label_key, label_value in worker_node_labels.items() %}
  - "{{ label_key }}={{ label_value }}"
{% endfor %}

# Kubelet configuration
kubelet-arg:
  - "node-ip={{ ansible_default_ipv4.address }}"
